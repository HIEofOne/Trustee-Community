var It=Object.create;var F=Object.defineProperty,Pt=Object.defineProperties,$t=Object.getOwnPropertyDescriptor,bt=Object.getOwnPropertyDescriptors,Mt=Object.getOwnPropertyNames,Fe=Object.getOwnPropertySymbols,Nt=Object.getPrototypeOf,We=Object.prototype.hasOwnProperty,wt=Object.prototype.propertyIsEnumerable;var Xe=(t,e,n)=>e in t?F(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,re=(t,e)=>{for(var n in e||(e={}))We.call(e,n)&&Xe(t,n,e[n]);if(Fe)for(var n of Fe(e))wt.call(e,n)&&Xe(t,n,e[n]);return t},Be=(t,e)=>Pt(t,bt(e)),He=t=>F(t,"__esModule",{value:!0});var At=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Ve=(t,e)=>{for(var n in e)F(t,n,{get:e[n],enumerable:!0})},ze=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Mt(e))!We.call(t,s)&&(n||s!=="default")&&F(t,s,{get:()=>e[s],enumerable:!(r=$t(e,s))||r.enumerable});return t},Lt=(t,e)=>ze(He(F(t!=null?It(Nt(t)):{},"default",!e&&t&&t.__esModule?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t),St=(t=>(e,n)=>t&&t.get(e)||(n=ze(He({}),e,1),t&&t.set(e,n),n))(typeof WeakMap!="undefined"?new WeakMap:0);var P=(t,e,n)=>new Promise((r,s)=>{var o=c=>{try{i(n.next(c))}catch(p){s(p)}},a=c=>{try{i(n.throw(c))}catch(p){s(p)}},i=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,a);i((n=n.apply(t,e)).next())});var Et=At((dr,Le)=>{"use strict";var wn=Object.prototype.hasOwnProperty,T="~";function Y(){}Object.create&&(Y.prototype=Object.create(null),new Y().__proto__||(T=!1));function An(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function mt(t,e,n,r,s){if(typeof n!="function")throw new TypeError("The listener must be a function");var o=new An(n,r||t,s),a=T?T+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],o]:t._events[a].push(o):(t._events[a]=o,t._eventsCount++),t}function pe(t,e){--t._eventsCount===0?t._events=new Y:delete t._events[e]}function y(){this._events=new Y,this._eventsCount=0}y.prototype.eventNames=function(){var e=[],n,r;if(this._eventsCount===0)return e;for(r in n=this._events)wn.call(n,r)&&e.push(T?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(n)):e};y.prototype.listeners=function(e){var n=T?T+e:e,r=this._events[n];if(!r)return[];if(r.fn)return[r.fn];for(var s=0,o=r.length,a=new Array(o);s<o;s++)a[s]=r[s].fn;return a};y.prototype.listenerCount=function(e){var n=T?T+e:e,r=this._events[n];return r?r.fn?1:r.length:0};y.prototype.emit=function(e,n,r,s,o,a){var i=T?T+e:e;if(!this._events[i])return!1;var c=this._events[i],p=arguments.length,l,u;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),p){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,n),!0;case 3:return c.fn.call(c.context,n,r),!0;case 4:return c.fn.call(c.context,n,r,s),!0;case 5:return c.fn.call(c.context,n,r,s,o),!0;case 6:return c.fn.call(c.context,n,r,s,o,a),!0}for(u=1,l=new Array(p-1);u<p;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var x=c.length,L;for(u=0;u<x;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),p){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,n);break;case 3:c[u].fn.call(c[u].context,n,r);break;case 4:c[u].fn.call(c[u].context,n,r,s);break;default:if(!l)for(L=1,l=new Array(p-1);L<p;L++)l[L-1]=arguments[L];c[u].fn.apply(c[u].context,l)}}return!0};y.prototype.on=function(e,n,r){return mt(this,e,n,r,!1)};y.prototype.once=function(e,n,r){return mt(this,e,n,r,!0)};y.prototype.removeListener=function(e,n,r,s){var o=T?T+e:e;if(!this._events[o])return this;if(!n)return pe(this,o),this;var a=this._events[o];if(a.fn)a.fn===n&&(!s||a.once)&&(!r||a.context===r)&&pe(this,o);else{for(var i=0,c=[],p=a.length;i<p;i++)(a[i].fn!==n||s&&!a[i].once||r&&a[i].context!==r)&&c.push(a[i]);c.length?this._events[o]=c.length===1?c[0]:c:pe(this,o)}return this};y.prototype.removeAllListeners=function(e){var n;return e?(n=T?T+e:e,this._events[n]&&pe(this,n)):(this._events=new Y,this._eventsCount=0),this};y.prototype.off=y.prototype.removeListener;y.prototype.addListener=y.prototype.on;y.prefixed=T;y.EventEmitter=y;typeof Le!="undefined"&&(Le.exports=y)});var zn={};Ve(zn,{Extension:()=>A,MagicExtensionError:()=>G,MagicExtensionWarning:()=>z,MagicRPCError:()=>N,MagicSDKError:()=>$,MagicSDKWarning:()=>q,SDKBase:()=>ye,STORE_KEY_PRIVATE_KEY:()=>he,STORE_KEY_PUBLIC_JWK:()=>ee,TypedEmitter:()=>Se,ViewController:()=>je,clearKeys:()=>ke,createDeprecationWarning:()=>$n,createDuplicateIframeWarning:()=>Pn,createExtensionNotInitializedError:()=>be,createIncompatibleExtensionsError:()=>Me,createInvalidArgumentError:()=>Ne,createJwt:()=>Je,createMalformedResponseError:()=>$e,createMissingApiKeyError:()=>Pe,createModalNotReadyError:()=>In,createPromiEvent:()=>Q,createPromise:()=>ue,createReactNativeEndpointConfigurationWarning:()=>Ae,createSDK:()=>lt,createSynchronousWeb3MethodWarning:()=>we,createTypedEmitter:()=>Z,createURL:()=>ge,decodeJSON:()=>ve,encodeJSON:()=>H,getPayloadId:()=>le,isEmpty:()=>V,isJsonRpcErrorCode:()=>Ie,isJsonRpcRequestPayload:()=>vn,isJsonRpcResponsePayload:()=>xe,isMagicPayloadMethod:()=>xn,isPromiEvent:()=>Oe,storage:()=>K,uuid:()=>_e});function Ot(t){let e={exports:{}};return t(e,e.exports),e.exports}var Ct=Number.MAX_SAFE_INTEGER||9007199254740991;var Re={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Ct,MAX_SAFE_COMPONENT_LENGTH:16},_t=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{},d=_t,W=Ot(function(t,e){let{MAX_SAFE_COMPONENT_LENGTH:n}=Re,r=(e=t.exports={}).re=[],s=e.src=[],o=e.t={},a=0,i=(c,p,l)=>{let u=a++;d(u,p),o[c]=u,s[u]=p,r[u]=new RegExp(p,l?"g":void 0)};i("NUMERICIDENTIFIER","0|[1-9]\\d*"),i("NUMERICIDENTIFIERLOOSE","[0-9]+"),i("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),i("MAINVERSION",`(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})`),i("MAINVERSIONLOOSE",`(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})`),i("PRERELEASEIDENTIFIER",`(?:${s[o.NUMERICIDENTIFIER]}|${s[o.NONNUMERICIDENTIFIER]})`),i("PRERELEASEIDENTIFIERLOOSE",`(?:${s[o.NUMERICIDENTIFIERLOOSE]}|${s[o.NONNUMERICIDENTIFIER]})`),i("PRERELEASE",`(?:-(${s[o.PRERELEASEIDENTIFIER]}(?:\\.${s[o.PRERELEASEIDENTIFIER]})*))`),i("PRERELEASELOOSE",`(?:-?(${s[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[o.PRERELEASEIDENTIFIERLOOSE]})*))`),i("BUILDIDENTIFIER","[0-9A-Za-z-]+"),i("BUILD",`(?:\\+(${s[o.BUILDIDENTIFIER]}(?:\\.${s[o.BUILDIDENTIFIER]})*))`),i("FULLPLAIN",`v?${s[o.MAINVERSION]}${s[o.PRERELEASE]}?${s[o.BUILD]}?`),i("FULL",`^${s[o.FULLPLAIN]}$`),i("LOOSEPLAIN",`[v=\\s]*${s[o.MAINVERSIONLOOSE]}${s[o.PRERELEASELOOSE]}?${s[o.BUILD]}?`),i("LOOSE",`^${s[o.LOOSEPLAIN]}$`),i("GTLT","((?:<|>)?=?)"),i("XRANGEIDENTIFIERLOOSE",`${s[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),i("XRANGEIDENTIFIER",`${s[o.NUMERICIDENTIFIER]}|x|X|\\*`),i("XRANGEPLAIN",`[v=\\s]*(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:${s[o.PRERELEASE]})?${s[o.BUILD]}?)?)?`),i("XRANGEPLAINLOOSE",`[v=\\s]*(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:${s[o.PRERELEASELOOSE]})?${s[o.BUILD]}?)?)?`),i("XRANGE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAIN]}$`),i("XRANGELOOSE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAINLOOSE]}$`),i("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),i("COERCERTL",s[o.COERCE],!0),i("LONETILDE","(?:~>?)"),i("TILDETRIM",`(\\s*)${s[o.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",i("TILDE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAIN]}$`),i("TILDELOOSE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAINLOOSE]}$`),i("LONECARET","(?:\\^)"),i("CARETTRIM",`(\\s*)${s[o.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",i("CARET",`^${s[o.LONECARET]}${s[o.XRANGEPLAIN]}$`),i("CARETLOOSE",`^${s[o.LONECARET]}${s[o.XRANGEPLAINLOOSE]}$`),i("COMPARATORLOOSE",`^${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]})$|^$`),i("COMPARATOR",`^${s[o.GTLT]}\\s*(${s[o.FULLPLAIN]})$|^$`),i("COMPARATORTRIM",`(\\s*)${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]}|${s[o.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",i("HYPHENRANGE",`^\\s*(${s[o.XRANGEPLAIN]})\\s+-\\s+(${s[o.XRANGEPLAIN]})\\s*$`),i("HYPHENRANGELOOSE",`^\\s*(${s[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[o.XRANGEPLAINLOOSE]})\\s*$`),i("STAR","(<|>)?=?\\s*\\*"),i("GTE0","^\\s*>=\\s*0.0.0\\s*$"),i("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")}),Ye=/^[0-9]+$/,Ze=(t,e)=>{let n=Ye.test(t),r=Ye.test(e);return n&&r&&(t=+t,e=+e),t===e?0:n&&!r?-1:r&&!n?1:t<e?-1:1},Dt=(t,e)=>Ze(e,t),kt={compareIdentifiers:Ze,rcompareIdentifiers:Dt},{MAX_LENGTH:Qe,MAX_SAFE_INTEGER:se}=Re,{re:et,t:tt}=W,{compareIdentifiers:X}=kt,E=class{constructor(e,n){if(n&&typeof n=="object"||(n={loose:!!n,includePrerelease:!1}),e instanceof E){if(e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid Version: ${e}`);if(e.length>Qe)throw new TypeError(`version is longer than ${Qe} characters`);d("SemVer",e,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;let r=e.trim().match(n.loose?et[tt.LOOSE]:et[tt.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>se||this.major<0)throw new TypeError("Invalid major version");if(this.minor>se||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>se||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){let o=+s;if(o>=0&&o<se)return o}return s}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(d("SemVer.compare",this.version,this.options,e),!(e instanceof E)){if(typeof e=="string"&&e===this.version)return 0;e=new E(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof E||(e=new E(e,this.options)),X(this.major,e.major)||X(this.minor,e.minor)||X(this.patch,e.patch)}comparePre(e){if(e instanceof E||(e=new E(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let n=0;do{let r=this.prerelease[n],s=e.prerelease[n];if(d("prerelease compare",n,r,s),r===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(r===void 0)return-1;if(r!==s)return X(r,s)}while(++n)}compareBuild(e){e instanceof E||(e=new E(e,this.options));let n=0;do{let r=this.build[n],s=e.build[n];if(d("prerelease compare",n,r,s),r===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(r===void 0)return-1;if(r!==s)return X(r,s)}while(++n)}inc(e,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n),this.inc("pre",n);break;case"major":this.minor===0&&this.patch===0&&this.prerelease.length!==0||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":this.patch===0&&this.prerelease.length!==0||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}},Jt=(t,e,n)=>new E(t,n).compare(new E(e,n)),J=Jt,qt=(t,e,n)=>J(t,e,n)===0,Gt=qt,Ut=(t,e,n)=>J(t,e,n)!==0,Kt=Ut,jt=(t,e,n)=>J(t,e,n)>0,Ft=jt,Wt=(t,e,n)=>J(t,e,n)>=0,Xt=Wt,Bt=(t,e,n)=>J(t,e,n)<0,Ht=Bt,Vt=(t,e,n)=>J(t,e,n)<=0,zt=Vt,Yt=(t,e,n,r)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof n=="object"&&(n=n.version),t===n;case"!==":return typeof t=="object"&&(t=t.version),typeof n=="object"&&(n=n.version),t!==n;case"":case"=":case"==":return Gt(t,n,r);case"!=":return Kt(t,n,r);case">":return Ft(t,n,r);case">=":return Xt(t,n,r);case"<":return Ht(t,n,r);case"<=":return zt(t,n,r);default:throw new TypeError(`Invalid operator: ${e}`)}},Te=Yt,B=Symbol("SemVer ANY"),C=class{static get ANY(){return B}constructor(e,n){if(n&&typeof n=="object"||(n={loose:!!n,includePrerelease:!1}),e instanceof C){if(e.loose===!!n.loose)return e;e=e.value}d("comparator",e,n),this.options=n,this.loose=!!n.loose,this.parse(e),this.semver===B?this.value="":this.value=this.operator+this.semver.version,d("comp",this)}parse(e){let n=this.options.loose?nt[rt.COMPARATORLOOSE]:nt[rt.COMPARATOR],r=e.match(n);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new E(r[2],this.options.loose):this.semver=B}toString(){return this.value}test(e){if(d("Comparator.test",e,this.options.loose),this.semver===B||e===B)return!0;if(typeof e=="string")try{e=new E(e,this.options)}catch(n){return!1}return Te(e,this.operator,this.semver,this.options)}intersects(e,n){if(!(e instanceof C))throw new TypeError("a Comparator is required");if(n&&typeof n=="object"||(n={loose:!!n,includePrerelease:!1}),this.operator==="")return this.value===""||new S(e.value,n).test(this.value);if(e.operator==="")return e.value===""||new S(this.value,n).test(e.semver);let r=!(this.operator!==">="&&this.operator!==">"||e.operator!==">="&&e.operator!==">"),s=!(this.operator!=="<="&&this.operator!=="<"||e.operator!=="<="&&e.operator!=="<"),o=this.semver.version===e.semver.version,a=!(this.operator!==">="&&this.operator!=="<="||e.operator!==">="&&e.operator!=="<="),i=Te(this.semver,"<",e.semver,n)&&(this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"),c=Te(this.semver,">",e.semver,n)&&(this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">");return r||s||o&&a||i||c}},{re:nt,t:rt}=W,S=class{constructor(e,n){if(n&&typeof n=="object"||(n={loose:!!n,includePrerelease:!1}),e instanceof S)return e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease?e:new S(e.raw,n);if(e instanceof C)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){let{loose:n}=this.options;e=e.trim();let r=n?g[f.HYPHENRANGELOOSE]:g[f.HYPHENRANGE];e=e.replace(r,un(this.options.includePrerelease)),d("hyphen replace",e),e=e.replace(g[f.COMPARATORTRIM],Zt),d("comparator trim",e,g[f.COMPARATORTRIM]),e=(e=(e=e.replace(g[f.TILDETRIM],Qt)).replace(g[f.CARETTRIM],en)).split(/\s+/).join(" ");let s=n?g[f.COMPARATORLOOSE]:g[f.COMPARATOR];return e.split(" ").map(o=>tn(o,this.options)).join(" ").split(/\s+/).map(o=>pn(o,this.options)).filter(this.options.loose?o=>!!o.match(s):()=>!0).map(o=>new C(o,this.options))}intersects(e,n){if(!(e instanceof S))throw new TypeError("a Range is required");return this.set.some(r=>st(r,n)&&e.set.some(s=>st(s,n)&&r.every(o=>s.every(a=>o.intersects(a,n)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new E(e,this.options)}catch(n){return!1}for(let n=0;n<this.set.length;n++)if(dn(this.set[n],e,this.options))return!0;return!1}},{re:g,t:f,comparatorTrimReplace:Zt,tildeTrimReplace:Qt,caretTrimReplace:en}=W,st=(t,e)=>{let n=!0,r=t.slice(),s=r.pop();for(;n&&r.length;)n=r.every(o=>s.intersects(o,e)),s=r.pop();return n},tn=(t,e)=>(d("comp",t,e),t=sn(t,e),d("caret",t),t=nn(t,e),d("tildes",t),t=an(t,e),d("xrange",t),t=ln(t,e),d("stars",t),t),R=t=>!t||t.toLowerCase()==="x"||t==="*",nn=(t,e)=>t.trim().split(/\s+/).map(n=>rn(n,e)).join(" "),rn=(t,e)=>{let n=e.loose?g[f.TILDELOOSE]:g[f.TILDE];return t.replace(n,(r,s,o,a,i)=>{let c;return d("tilde",t,r,s,o,a,i),R(s)?c="":R(o)?c=`>=${s}.0.0 <${+s+1}.0.0-0`:R(a)?c=`>=${s}.${o}.0 <${s}.${+o+1}.0-0`:i?(d("replaceTilde pr",i),c=`>=${s}.${o}.${a}-${i} <${s}.${+o+1}.0-0`):c=`>=${s}.${o}.${a} <${s}.${+o+1}.0-0`,d("tilde return",c),c})},sn=(t,e)=>t.trim().split(/\s+/).map(n=>on(n,e)).join(" "),on=(t,e)=>{d("caret",t,e);let n=e.loose?g[f.CARETLOOSE]:g[f.CARET],r=e.includePrerelease?"-0":"";return t.replace(n,(s,o,a,i,c)=>{let p;return d("caret",t,s,o,a,i,c),R(o)?p="":R(a)?p=`>=${o}.0.0${r} <${+o+1}.0.0-0`:R(i)?p=o==="0"?`>=${o}.${a}.0${r} <${o}.${+a+1}.0-0`:`>=${o}.${a}.0${r} <${+o+1}.0.0-0`:c?(d("replaceCaret pr",c),p=o==="0"?a==="0"?`>=${o}.${a}.${i}-${c} <${o}.${a}.${+i+1}-0`:`>=${o}.${a}.${i}-${c} <${o}.${+a+1}.0-0`:`>=${o}.${a}.${i}-${c} <${+o+1}.0.0-0`):(d("no pr"),p=o==="0"?a==="0"?`>=${o}.${a}.${i}${r} <${o}.${a}.${+i+1}-0`:`>=${o}.${a}.${i}${r} <${o}.${+a+1}.0-0`:`>=${o}.${a}.${i} <${+o+1}.0.0-0`),d("caret return",p),p})},an=(t,e)=>(d("replaceXRanges",t,e),t.split(/\s+/).map(n=>cn(n,e)).join(" ")),cn=(t,e)=>{t=t.trim();let n=e.loose?g[f.XRANGELOOSE]:g[f.XRANGE];return t.replace(n,(r,s,o,a,i,c)=>{d("xRange",t,r,s,o,a,i,c);let p=R(o),l=p||R(a),u=l||R(i),x=u;return s==="="&&x&&(s=""),c=e.includePrerelease?"-0":"",p?r=s===">"||s==="<"?"<0.0.0-0":"*":s&&x?(l&&(a=0),i=0,s===">"?(s=">=",l?(o=+o+1,a=0,i=0):(a=+a+1,i=0)):s==="<="&&(s="<",l?o=+o+1:a=+a+1),s==="<"&&(c="-0"),r=`${s+o}.${a}.${i}${c}`):l?r=`>=${o}.0.0${c} <${+o+1}.0.0-0`:u&&(r=`>=${o}.${a}.0${c} <${o}.${+a+1}.0-0`),d("xRange return",r),r})},ln=(t,e)=>(d("replaceStars",t,e),t.trim().replace(g[f.STAR],"")),pn=(t,e)=>(d("replaceGTE0",t,e),t.trim().replace(g[e.includePrerelease?f.GTE0PRE:f.GTE0],"")),un=t=>(e,n,r,s,o,a,i,c,p,l,u,x,L)=>`${n=R(r)?"":R(s)?`>=${r}.0.0${t?"-0":""}`:R(o)?`>=${r}.${s}.0${t?"-0":""}`:a?`>=${n}`:`>=${n}${t?"-0":""}`} ${c=R(p)?"":R(l)?`<${+p+1}.0.0-0`:R(u)?`<${p}.${+l+1}.0-0`:x?`<=${p}.${l}.${u}-${x}`:t?`<${p}.${l}.${+u+1}-0`:`<=${c}`}`.trim(),dn=(t,e,n)=>{for(let r=0;r<t.length;r++)if(!t[r].test(e))return!1;if(e.prerelease.length&&!n.includePrerelease){for(let r=0;r<t.length;r++)if(d(t[r].semver),t[r].semver!==C.ANY&&t[r].semver.prerelease.length>0){let s=t[r].semver;if(s.major===e.major&&s.minor===e.minor&&s.patch===e.patch)return!0}return!1}return!0},ot=(t,e,n)=>{try{e=new S(e,n)}catch(r){return!1}return e.test(t)};var{MAX_LENGTH:mn}=Re,{re:it,t:at}=W,En=(t,e)=>{if(e&&typeof e=="object"||(e={loose:!!e,includePrerelease:!1}),t instanceof E)return t;if(typeof t!="string"||t.length>mn||!(e.loose?it[at.LOOSE]:it[at.FULL]).test(t))return null;try{return new E(t,e)}catch(n){return null}},hn=En,{re:oe,t:ie}=W,ct=(t,e)=>{if(t instanceof E)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;let n=null;if((e=e||{}).rtl){let r;for(;(r=oe[ie.COERCERTL].exec(t))&&(!n||n.index+n[0].length!==t.length);)n&&r.index+r[0].length===n.index+n[0].length||(n=r),oe[ie.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;oe[ie.COERCERTL].lastIndex=-1}else n=t.match(oe[ie.COERCE]);return n===null?null:hn(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,e)};function fn(t){return String.fromCharCode(parseInt(t.slice(1),16))}function gn(t){return`%${`00${t.charCodeAt(0).toString(16)}`.slice(-2)}`}function yn(t){return btoa(encodeURIComponent(t).replace(/%[0-9A-F]{2}/g,fn))}function Rn(t){return decodeURIComponent(Array.from(atob(t),gn).join(""))}function H(t){return yn(JSON.stringify(t))}function ve(t){return JSON.parse(Rn(t))}var I=require("@magic-sdk/types");var ae=require("@magic-sdk/types");function M(t){return typeof t=="undefined"}function Tn(t){return t===null}function ce(t){return Tn(t)||M(t)}function vn(t){return ce(t)?!1:!M(t.jsonrpc)&&!M(t.id)&&!M(t.method)&&!M(t.params)}function xe(t){return ce(t)?!1:!M(t.jsonrpc)&&!M(t.id)&&(!M(t.result)||!M(t.error))}function xn(t){return ce(t)?!1:typeof t=="string"&&Object.values(ae.MagicPayloadMethod).includes(t)}function Ie(t){return ce(t)?!1:typeof t=="number"&&Object.values(ae.RPCErrorCode).includes(t)}function V(t){if(!t)return!0;for(let e in t)if(Object.hasOwnProperty.call(t,e))return!1;return!0}var m={};function lt(t,e){return Object.assign(m,e),t}var pt={"magic-sdk":"magic-sdk","@magic-sdk/react-native":"magic-sdk-rn"};var $=class extends Error{constructor(e,n){super(`Magic SDK Error: [${e}] ${n}`);this.code=e;this.rawMessage=n;this.__proto__=Error;Object.setPrototypeOf(this,$.prototype)}},N=class extends Error{constructor(e){super();this.__proto__=Error;let n=Number(e==null?void 0:e.code);this.rawMessage=(e==null?void 0:e.message)||"Internal error",this.code=Ie(n)?n:I.RPCErrorCode.InternalError,this.message=`Magic RPC Error: [${this.code}] ${this.rawMessage}`,Object.setPrototypeOf(this,N.prototype)}},q=class{constructor(e,n){this.code=e;this.rawMessage=n;this.message=`Magic SDK Warning: [${e}] ${n}`}log(){console.warn(this.message)}},G=class extends Error{constructor(e,n,r,s){super(`Magic Extension Error (${e.name}): [${n}] ${r}`);this.code=n;this.rawMessage=r;this.data=s;this.__proto__=Error;Object.setPrototypeOf(this,G.prototype)}},z=class{constructor(e,n,r){this.code=n;this.rawMessage=r;this.message=`Magic Extension Warning (${e.name}): [${n}] ${r}`}log(){console.warn(this.message)}};function Pe(){return new $(I.SDKErrorCode.MissingApiKey,"Please provide an API key that you acquired from the Magic developer dashboard.")}function In(){return new $(I.SDKErrorCode.ModalNotReady,"Modal is not ready.")}function $e(){return new $(I.SDKErrorCode.MalformedResponse,"Response from the Magic iframe is malformed.")}function be(t){return new $(I.SDKErrorCode.ExtensionNotInitialized,`Extensions must be initialized with a Magic SDK instance before \`Extension.${t}\` can be accessed. Do not invoke \`Extension.${t}\` inside an extension constructor.`)}function Me(t){let e=`Some extensions are incompatible with \`${m.sdkName}@${m.version}\`:`;return t.filter(n=>typeof n.compat!="undefined"&&n.compat!==null).forEach(n=>{let r=n.compat[m.sdkName];typeof r=="string"?e+=`
  - Extension \`${n.name}\` supports version(s) \`${r}\``:r||(e+=`
  - Extension \`${n.name}\` does not support ${m.platform} environments.`)}),new $(I.SDKErrorCode.IncompatibleExtensions,e)}function Ne(t){let e=n=>{let r=n+1,s=r%10,o=r%100;return s===1&&o!==11?`${r}st`:s===2&&o!==12?`${r}nd`:s===3&&o!==13?`${r}rd`:`${r}th`};return new $(I.SDKErrorCode.InvalidArgument,`Invalid ${e(t.argument)} argument given to \`${t.procedure}\`.
  Expected: \`${t.expected}\`
  Received: \`${t.received}\``)}function Pn(){return new q(I.SDKWarningCode.DuplicateIframe,"Duplicate iframes found.")}function we(){return new q(I.SDKWarningCode.SyncWeb3Method,"Non-async web3 methods are deprecated in web3 > 1.0 and are not supported by the Magic web3 provider. Please use an async method instead.")}function Ae(){return new q(I.SDKWarningCode.ReactNativeEndpointConfiguration,`CUSTOM DOMAINS ARE NOT SUPPORTED WHEN USING MAGIC SDK WITH REACT NATIVE! The \`endpoint\` parameter SHOULD NOT be provided. The Magic \`<iframe>\` is automatically wrapped by a WebView pointed at \`${m.defaultEndpoint}\`. Changing this default behavior will lead to unexpected results and potentially security-threatening bugs.`)}function $n(t){let{method:e,removalVersions:n,useInstead:r}=t,s=n[m.sdkName],o=r?` Use \`${r}\` instead.`:"",a=`\`${e}\` will be removed from \`${m.sdkName}\` in version \`${s}\`.${o}`;return new q(I.SDKWarningCode.DeprecationNotice,a)}var w=require("@magic-sdk/types");var de=require("@magic-sdk/types");function*bn(){let t=0;for(;;)t<Number.MAX_SAFE_INTEGER?yield++t:t=0}var Mn=bn();function le(){return Mn.next().value}var ut=Symbol("Payload pre-processed by Magic SDK");function dt(t){return Object.defineProperty(t,ut,{value:!0,enumerable:!1}),t}function Nn(t){return!!t[ut]}function _(t){var e,n,r;return Nn(t)||(t.jsonrpc=(e=t.jsonrpc)!=null?e:"2.0",t.id=le(),t.method=(n=t.method)!=null?n:"noop",t.params=(r=t.params)!=null?r:[],dt(t)),t}function h(t,e=[]){return dt({params:e,method:t,jsonrpc:"2.0",id:le()})}var D=class{constructor(e){e instanceof D?(this._jsonrpc=e.payload.jsonrpc,this._id=e.payload.id,this._result=e.payload.result,this._error=e.payload.error):xe(e)?(this._jsonrpc=e.jsonrpc,this._id=e.id,this._result=e.result,this._error=e.error):(this._jsonrpc=e.jsonrpc,this._id=e.id,this._result=void 0,this._error=void 0)}applyError(e){return this._error=e,this}applyResult(e){return this._result=e,this}get hasError(){return typeof this._error!="undefined"&&this._error!==null}get hasResult(){return typeof this._result!="undefined"}get payload(){return{jsonrpc:this._jsonrpc,id:this._id,result:this._result,error:this._error}}};var ht=Lt(Et()),Se=class extends ht.default{};function Z(){let t=new Se;return{emitter:t,createChainingEmitterMethod:(r,s)=>(...o)=>(t[r].apply(t,o),s),createBoundEmitterMethod:r=>(...s)=>t[r].apply(t,s)}}var ft=Symbol("isPromiEvent");function Oe(t){return!!t[ft]}function Q(t){let e=ue(t),{createBoundEmitterMethod:n,createChainingEmitterMethod:r}=Z(),s=Symbol("Promise.then"),o=Symbol("Promise.catch"),a=Symbol("Promise.finally"),i=(l,u)=>(...x)=>{let L=u[l].apply(u,x);return c(L)},c=l=>Object.assign(l,{[ft]:!0,[s]:l[s]||l.then,[o]:l[o]||l.catch,[a]:l[a]||l.finally,then:i(s,l),catch:i(o,l),finally:i(a,l),on:r("on",l),once:r("once",l),addListener:r("addListener",l),off:r("off",l),removeListener:r("removeListener",l),removeAllListeners:r("removeAllListeners",l),emit:n("emit"),eventNames:n("eventNames"),listeners:n("listeners"),listenerCount:n("listenerCount")}),p=c(e.then(l=>(p.emit("done",l),p.emit("settled"),l),l=>{throw p.emit("error",l),p.emit("settled"),l}));return p}function ue(t){return new Promise((e,n)=>{let r=t(e,n);Promise.resolve(r).catch(n)})}var b=class{constructor(e){this.sdk=e}get overlay(){return this.sdk.overlay}request(e){let n=this.overlay.post(de.MagicOutgoingWindowMessage.MAGIC_HANDLE_REQUEST,_(e)),r=Q((o,a)=>{n.then(i=>{if(s(),i.hasError)a(new N(i.payload.error));else if(i.hasResult)o(i.payload.result);else throw $e()}).catch(i=>{s(),a(i)})}),s=this.overlay.on(de.MagicIncomingWindowMessage.MAGIC_HANDLE_EVENT,o=>{var i;let{response:a}=o.data;if(a.id===e.id&&((i=a.result)==null?void 0:i.event)){let{event:c,params:p=[]}=a.result;r.emit(c,...p)}});return r}};var Ce=class extends b{loginWithMagicLink(e){let{email:n,showUI:r=!0,redirectURI:s}=e,o=h(this.sdk.testMode?w.MagicPayloadMethod.LoginWithMagicLinkTestMode:w.MagicPayloadMethod.LoginWithMagicLink,[{email:n,showUI:r,redirectURI:s}]);return this.request(o)}loginWithSMS(e){let{phoneNumber:n}=e,r=h(this.sdk.testMode?w.MagicPayloadMethod.LoginWithSmsTestMode:w.MagicPayloadMethod.LoginWithSms,[{phoneNumber:n,showUI:!0}]);return this.request(r)}loginWithEmailOTP(e){let{email:n}=e,r=h(this.sdk.testMode?w.MagicPayloadMethod.LoginWithEmailOTPTestMode:w.MagicPayloadMethod.LoginWithEmailOTP,[{email:n,showUI:!0}]);return this.request(r)}loginWithCredential(e){let n=e!=null?e:"";if(!e&&m.platform==="web"){n=window.location.search;let s=window.location.origin+window.location.pathname;window.history.replaceState(null,"",s)}let r=h(this.sdk.testMode?w.MagicPayloadMethod.LoginWithCredentialTestMode:w.MagicPayloadMethod.LoginWithCredential,[n]);return this.request(r)}};var v=require("@magic-sdk/types");var K={};Ve(K,{clear:()=>Ln,getItem:()=>k,iterate:()=>_n,key:()=>On,keys:()=>Cn,length:()=>Sn,removeItem:()=>Ee,setItem:()=>U});var me;function O(t){return(...e)=>P(this,null,function*(){return me||(me=yield m.configureStorage()),yield me.ready(),me[t](...e)})}var k=O("getItem"),U=O("setItem"),Ee=O("removeItem"),Ln=O("clear"),Sn=O("length"),On=O("key"),Cn=O("keys"),_n=O("iterate");function _e(){let t=window.crypto.getRandomValues(new Uint8Array(16));t[6]=t[6]&15|64,t[8]=t[8]&191|128;let e="";return e+=t[0].toString(16),e+=t[1].toString(16),e+=t[2].toString(16),e+=t[3].toString(16),e+="-",e+=t[4].toString(16),e+=t[5].toString(16),e+="-",e+=t[6].toString(16),e+=t[7].toString(16),e+="-",e+=t[8].toString(16),e+=t[9].toString(16),e+="-",e+=t[10].toString(16),e+=t[11].toString(16),e+=t[12].toString(16),e+=t[13].toString(16),e+=t[14].toString(16),e+=t[15].toString(16),e}var he="STORE_KEY_PRIVATE_KEY",ee="STORE_KEY_PUBLIC_JWK",De="ECDSA",gt="P-256",Dn={name:De,namedCurve:gt},kn={name:De,namedCurve:gt};function ke(){Ee(ee),Ee(he)}function Je(){return P(this,null,function*(){let t=yield Jn();if(!t){console.info("unable to create public key or webcrypto is unsupported");return}let{subtle:e}=window.crypto,n=yield k(he);if(!n||!e){console.info("unable to find private key or webcrypto unsupported");return}let r={iat:Math.floor(new Date().getTime()/1e3),jti:_e()},s={typ:"dpop+jwt",alg:"ES256",jwk:t},o={protected:yt(JSON.stringify(s)),claims:yt(JSON.stringify(r))},a=Un(`${o.protected}.${o.claims}`),i={name:De,hash:{name:"SHA-256"}},c=jn(new Uint8Array(yield e.sign(i,n,a)));return`${o.protected}.${o.claims}.${c}`})}function Jn(){return P(this,null,function*(){if(!Gn()){console.info("webcrypto is not supported");return}return(yield k(ee))||(yield qn()),k(ee)})}function qn(){return P(this,null,function*(){let t=null,{subtle:e}=window.crypto,n=yield e.generateKey(Dn,!0,["sign"]),r=yield e.exportKey("jwk",n.privateKey);t=yield e.exportKey("jwk",n.publicKey);let s=yield e.importKey("jwk",r,kn,!1,["sign"]);yield U(he,s),yield U(ee,t)})}function Gn(){let t=typeof window!="undefined"&&!!window.crypto,e=t&&!!window.crypto.subtle;return t&&e}function yt(t){return Rt(Kn(t))}function Un(t){return new TextEncoder().encode(t)}function Rt(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+/g,"")}function Kn(t){return encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(n,r)=>String.fromCharCode(parseInt(r,16)))}function jn(t){let e="";return t.forEach(n=>{e+=String.fromCharCode(n)}),Rt(e)}var qe=class extends b{getIdToken(e){let n=h(this.sdk.testMode?v.MagicPayloadMethod.GetIdTokenTestMode:v.MagicPayloadMethod.GetIdToken,[e]);return this.request(n)}generateIdToken(e){let n=h(this.sdk.testMode?v.MagicPayloadMethod.GenerateIdTokenTestMode:v.MagicPayloadMethod.GenerateIdToken,[e]);return this.request(n)}getMetadata(){let e=h(this.sdk.testMode?v.MagicPayloadMethod.GetMetadataTestMode:v.MagicPayloadMethod.GetMetadata);return this.request(e)}updateEmail(e){let{email:n,showUI:r=!0}=e,s=h(this.sdk.testMode?v.MagicPayloadMethod.UpdateEmailTestMode:v.MagicPayloadMethod.UpdateEmail,[{email:n,showUI:r}]);return this.request(s)}isLoggedIn(){let e=h(this.sdk.testMode?v.MagicPayloadMethod.IsLoggedInTestMode:v.MagicPayloadMethod.IsLoggedIn);return this.request(e)}logout(){ke();let e=h(this.sdk.testMode?v.MagicPayloadMethod.LogoutTestMode:v.MagicPayloadMethod.Logout);return this.request(e)}showSettings(){let e=h(this.sdk.testMode?v.MagicPayloadMethod.UserSettingsTestMode:v.MagicPayloadMethod.UserSettings);return this.request(e)}};var Ge=require("@magic-sdk/types");var{createBoundEmitterMethod:fe,createChainingEmitterMethod:j}=Z(),Ue=class extends b{constructor(){super(...arguments);this.isMagic=!0;this.on=j("on",this);this.once=j("once",this);this.addListener=j("addListener",this);this.off=j("off",this);this.removeListener=j("removeListener",this);this.removeAllListeners=j("removeAllListeners",this);this.emit=fe("emit");this.eventNames=fe("eventNames");this.listeners=fe("listeners");this.listenerCount=fe("listenerCount")}sendAsync(e,n){if(!n)throw Ne({procedure:"Magic.rpcProvider.sendAsync",argument:1,expected:"function",received:n===null?"null":typeof n});if(Array.isArray(e))this.overlay.post(Ge.MagicOutgoingWindowMessage.MAGIC_HANDLE_REQUEST,e.map(r=>{let s=_(r);return this.prefixPayloadMethodForTestMode(s),s})).then(r=>{n(null,r.map(s=>Be(re({},s.payload),{error:s.hasError?new N(s.payload.error):null})))});else{let r=_(e);this.prefixPayloadMethodForTestMode(r),this.overlay.post(Ge.MagicOutgoingWindowMessage.MAGIC_HANDLE_REQUEST,r).then(s=>{n(s.hasError?new N(s.payload.error):null,s.payload)})}}send(e,n){if(typeof e=="string"){let s=h(e,Array.isArray(n)?n:[]);return this.request(s)}if(Array.isArray(e)||!!n){this.sendAsync(e,n);return}let r=we();return r.log(),new D(e).applyError({code:-32603,message:r.rawMessage}).payload}enable(){let e=h("eth_accounts");return this.request(e)}request(e){return this.prefixPayloadMethodForTestMode(e),super.request(e)}prefixPayloadMethodForTestMode(e){let n="testMode/eth/";this.sdk.testMode&&(e.method=`${n}${e.method}`)}};function ge(t,e){return e?new URL(t,e):new URL(t)}var Tt=["request","overlay","sdk"];function Fn(t){let e=Object.getPrototypeOf(t),n=[e];for(;e!==b.prototype;)e=Object.getPrototypeOf(e),n.push(e);return n}var Ke=class extends b{constructor(){super(void 0);this.__sdk_access_field_descriptors__=new Map;this.__is_initialized__=!1;this.utils={createPromiEvent:Q,isPromiEvent:Oe,encodeJSON:H,decodeJSON:ve,createJsonRpcRequestPayload:h,standardizeJsonRpcRequestPayload:_,storage:K};let e=[this,...Fn(this)];Tt.forEach(n=>{let r=e.map(i=>Object.getOwnPropertyDescriptor(i,n)),s=r.findIndex(i=>!!i),o=s>0,a=r[s];a&&(this.__sdk_access_field_descriptors__.set(n,{descriptor:a,isPrototypeField:o}),Object.defineProperty(this,n,{configurable:!0,get:()=>{throw be(n)}}))})}init(e){this.__is_initialized__||(Tt.forEach(n=>{if(this.__sdk_access_field_descriptors__.has(n)){let{descriptor:r,isPrototypeField:s}=this.__sdk_access_field_descriptors__.get(n);s?delete this[n]:Object.defineProperty(this,n,r)}}),this.sdk=e,this.__is_initialized__=!0)}createDeprecationWarning(e){let{method:n,removalVersion:r,useInstead:s}=e,o=s?` Use \`${s}\` instead.`:"",a=`\`${n}\` will be removed from this Extension in version \`${r}\`.${o}`;return new z(this,"DEPRECATION_NOTICE",a)}createWarning(e,n){return new z(this,e,n)}createError(e,n,r){return new G(this,e,n,r)}},vt=class extends Ke{},A=class extends Ke{};A.Internal=vt,A.Anonymous="anonymous extension";function xt(t){return t.compat&&t.compat[m.sdkName]!=null?typeof t.compat[m.sdkName]=="string"?ot(ct(m.version),t.compat[m.sdkName]):!!t.compat[m.sdkName]:!0}function Wn(t){var s;let e=(s=t==null?void 0:t.extensions)!=null?s:[],n={},r=[];if(Array.isArray(e)?e.forEach(o=>{xt(o)?(o.init(this),(o.name||o.name!==A.Anonymous)&&(this[o.name]=o),o instanceof A.Internal&&(V(o.config)||(n[o.name]=o.config))):r.push(o)}):Object.keys(e).forEach(o=>{if(xt(e[o])){e[o].init(this);let a=e[o];this[o]=a,a instanceof A.Internal&&(V(a.config)||(n[e[o].name]=a.config))}else r.push(e[o])}),r.length)throw Me(r);return n}var te=class{constructor(e,n){this.apiKey=e;var a;if(!e)throw Pe();m.platform==="react-native"&&(n==null?void 0:n.endpoint)&&Ae().log();let{defaultEndpoint:r,version:s}=m;this.testMode=!!(n==null?void 0:n.testMode),this.endpoint=ge((a=n==null?void 0:n.endpoint)!=null?a:r).origin,this.auth=new Ce(this),this.user=new qe(this),this.rpcProvider=new Ue(this);let o=Wn.call(this,n);this.parameters=H(re({API_KEY:this.apiKey,DOMAIN_ORIGIN:window.location?window.location.origin:"",ETH_NETWORK:n==null?void 0:n.network,host:ge(this.endpoint).host,sdk:pt[m.sdkName],version:s,ext:V(o)?void 0:o,locale:(n==null?void 0:n.locale)||"en_US"},m.bundleId?{bundleId:m.bundleId}:{}))}get overlay(){if(!te.__overlays__.has(this.parameters)){let e=new m.ViewController(this.endpoint,this.parameters);e.init(),te.__overlays__.set(this.parameters,e)}return te.__overlays__.get(this.parameters)}preload(){return P(this,null,function*(){yield this.overlay.ready})}},ye=te;ye.__overlays__=new Map;var ne=require("@magic-sdk/types");function Xn(t,e){return e&&Array.isArray(t)?t.find(n=>n.id===e):t}function Bn(t,e){var s;let n=(s=e.data.response)==null?void 0:s.id,r=Xn(t,n);if(n&&r){let o=new D(r).applyResult(e.data.response.result).applyError(e.data.response.error);return{id:n,response:o}}return{}}function Hn(t,e){return P(this,null,function*(){let n=yield k("rt"),r;if(m.platform==="web")try{r=yield Je()}catch(s){console.error("webcrypto error",s)}return r?n?{msgType:t,payload:e,jwt:r,rt:n}:{msgType:t,payload:e,jwt:r}:{msgType:t,payload:e}})}function Vn(t){return P(this,null,function*(){!t.data.rt||(yield U("rt",t.data.rt))})}var je=class{constructor(e,n){this.endpoint=e;this.parameters=n;this.messageHandlers=new Set;this.ready=this.waitForReady(),this.listen()}post(e,n){return P(this,null,function*(){return ue(r=>P(this,null,function*(){yield this.ready;let s=[],o=Array.isArray(n)?n.map(p=>p.id):[],a=yield Hn(`${e}-${this.parameters}`,n);yield this._post(a);let i=p=>l=>{let{id:u,response:x}=Bn(n,l);Vn(l),u&&x&&Array.isArray(n)&&o.includes(u)?(s.push(x),s.length===n.length&&(p(),r(s))):u&&x&&!Array.isArray(n)&&u===n.id&&(p(),r(x))},c=this.on(ne.MagicIncomingWindowMessage.MAGIC_HANDLE_RESPONSE,i(()=>c()))}))})}on(e,n){let r=n.bind(window),s=o=>{o.data.msgType===`${e}-${this.parameters}`&&r(o)};return this.messageHandlers.add(s),()=>this.messageHandlers.delete(s)}waitForReady(){return new Promise(e=>{this.on(ne.MagicIncomingWindowMessage.MAGIC_OVERLAY_READY,()=>e())})}listen(){this.on(ne.MagicIncomingWindowMessage.MAGIC_HIDE_OVERLAY,()=>{this.hideOverlay()}),this.on(ne.MagicIncomingWindowMessage.MAGIC_SHOW_OVERLAY,()=>{this.showOverlay()})}};module.exports=St(zn);
//# sourceMappingURL=index.js.map
